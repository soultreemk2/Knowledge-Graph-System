출처: https://docs.ampligraph.org/en/1.3.2/index.html


import numpy as np
import pandas as pd
import ampligraph
import tensorflow as tf

import requests
from ampligraph.datasets import load_from_csv
from ampligraph.evaluation import train_test_split_no_unseen 
from ampligraph.latent_features import save_model, restore_model

from ampligraph.evaluation import evaluate_performance, filter_unseen_entities
from ampligraph.evaluation import mr_score, mrr_score, hits_at_n_score
from scipy.special import expit

from ampligraph.discovery import discover_facts
from ampligraph.discovery import query_topn


#### 1. 데이터셋 불러오기 <s,r,o>

path = 'C:/Users/yangjh3/Desktop/업무폴더/Knowlege_Graph/예시데이터/'

data_total = pd.read_csv(path + '주간보고_SRO추출.csv', encoding='cp949')
data_total = data_total[['subject','relation','object']]
X = np.array(data_total, dtype='object')

entities = np.unique(np.concatenate([X[:, 0], X[:, 2]]))
relations = np.unique(X[:, 1])

Defining train and test datasets

num_test = int(len(X) * 0.04)

data = {}
data['train'], data['test'] = train_test_split_no_unseen(X, test_size=num_test, seed=0, allow_duplication=False) 


